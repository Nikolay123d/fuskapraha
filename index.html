<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>makame.cz â€” PRÃCE CZ CHAT</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
  <link rel="stylesheet" href="./style.css">
  <script>
  // Early bg: remove flicker
  (function(){
    try{
      var city=(localStorage.getItem('city')||'praha').toLowerCase();
      var key='bg_'+city;
      var url=localStorage.getItem(key)||localStorage.getItem('bg_default');
      if(url){
        var st=document.createElement('style');
        st.textContent='body{background-image:url('+JSON.stringify(url)+');background-size:cover;background-position:center;background-attachment:fixed;background-color:#091317}';
        document.head.appendChild(st);
      }
    }catch(e){}
  })();
  </script>
</head>
<body>
<div id="preloader"><div class="loader"></div>NaÄÃ­tÃ¡mâ€¦</div>

<header class="topbar">
  <div class="left">
    <button id="toggleTabs" class="ghost">â˜° Menu</button>
    <div class="brand">makame.cz <span class="slogan" data-i18n="brand_slogan">â€” prÃ¡ce zaÄÃ­nÃ¡ z makame.cz</span></div>
    <label class="citysel">
      <span data-i18n="city">MÄ›sto:</span>
      <select id="citySelect">
        <option value="praha">Praha</option>
        <option value="brno">Brno</option>
        <option value="ostrava">Ostrava</option>
        <option value="plzen">PlzeÅˆ</option>
        <option value="olomouc">Olomouc</option>
      </select>
    </label>
  </div>
  <div class="mid"><span id="onlineCounter">Online ~0</span></div>
  <div class="right">
    <button id="participantsBtn" title="ÃšÄastnÃ­ci" data-view="view-chat">ğŸ‘¥</button>
    <button id="friendsBtn" title="PÅ™Ã¡telÃ©" data-view="view-friends">ğŸ‘«</button>
    <button id="profileBtn" title="Profil" data-view="view-profile">Profil</button>
  </div>
</header>

<nav class="tabs" id="tabs">
  <button data-view="view-chat" class="tab active" data-i18n="chat">ğŸ’¬ Chat</button>
  <button data-view="view-rent" class="tab" data-i18n="rent">ğŸ  PronÃ¡jem</button>
  <button data-view="view-map" class="tab" data-i18n="map">ğŸ—ºï¸ Mapa</button>
  <button data-view="view-dm" class="tab" data-i18n="dm">âœ‰ï¸ OsobnÃ­</button>
  <button data-view="view-help" class="tab" data-i18n="help">ğŸ†˜ Pomoc</button>
  <button data-view="view-announce" class="tab" data-i18n="announce">ğŸ“¢ OznÃ¡menÃ­</button>
  <button data-view="view-admin" class="tab adm-only">ğŸ›  <span data-i18n="admin">Admin</span></button>
</nav>

<main id="views">
  <!-- CHAT -->
  <section id="view-chat" class="view active">
    <div id="chatFeed" class="feed"></div>
    <div id="chatToast" class="toast" hidden>âœ”ï¸ Fotka pÅ™idÃ¡na. KliknÄ›te â€Odeslatâ€œ.</div>
    <div class="composer sticky">
      <label class="filebtn" title="Foto"><input type="file" id="chatFile" accept="image/*" capture="environment">ğŸ“·</label>
      <input id="chatInput" placeholder="NapiÅ¡te zprÃ¡vuâ€¦ (mÅ¯Å¾e bÃ½t URL na obrÃ¡zek)">
      <button id="chatSend">Odeslat</button>
      <button id="clearChat" class="adm-only">ğŸ§¹ VyÄistit</button>
    </div>
  </section>

  <!-- RENT with filters/sort -->
  <section id="view-rent" class="view">
    <div class="row">
      <input id="rentSearch" placeholder="Hledatâ€¦">
      <select id="rentCityFilter">
        <option value="">VÅ¡echna mÄ›sta</option>
        <option>Praha</option><option>Brno</option><option>Ostrava</option><option>PlzeÅˆ</option><option>Olomouc</option>
      </select>
      <select id="rentSort">
        <option value="ts_desc">NejnovÄ›jÅ¡Ã­</option>
        <option value="price_asc">Cena â†‘</option>
        <option value="price_desc">Cena â†“</option>
      </select>
      <button id="rentApply">Filtr</button>
    </div>
    <div id="rentFeed" class="feed"></div>
    <div class="composer sticky">
      <label class="filebtn"><input type="file" id="rentFile" accept="image/*" capture="environment">ğŸ“·</label>
      <input id="rentInput" placeholder="InzerÃ¡tâ€¦ (napÅ™. 2+kk, 20 000 KÄ, Praha)">
      <button id="rentSend">Odeslat</button>
    </div>
  </section>

  <!-- MAP (POI photo base64) -->
  <section id="view-map" class="view">
    <div class="row">
      <button id="mapCenter">Centrovat</button>
      <label class="filebtn adm-only" title="PozadÃ­ mÄ›sta"><input type="file" id="cityBgFile" accept="image/*" capture="environment">ğŸ“·</label>
      <input id="cityBgUrl" class="adm-only" placeholder="URL pozadÃ­">
      <button id="saveCityBg" class="adm-only">UloÅ¾it</button>
    </div>
    <div id="map" class="map"></div>
    <div class="adm-only row">
      <input id="poiTitle" placeholder="NÃ¡zev">
      <input id="poiType" placeholder="Typ (vol/help/pharm)">
      <input id="poiAvatar" placeholder="URL avataru (volitelnÄ›)">
      <input id="poiPhoto" placeholder="URL nebo nechte prÃ¡zdnÃ© (vyuÅ¾ijte ğŸ“·)">
      <label class="filebtn"><input type="file" id="poiFile" accept="image/*" capture="environment">ğŸ“·</label>
      <input id="poiLat" placeholder="lat (volitelnÄ›)">
      <input id="poiLng" placeholder="lng (volitelnÄ›)">
      <button id="poiAdd">PÅ™idat bod</button>
    </div>
  </section>

  <!-- DMs -->
  <section id="view-dm" class="view">
    <div class="dm">
      <aside id="dmSidebar"></aside>
      <div class="dmThread">
        <div id="dmHeader"></div>
        <div id="dmMessages"></div>
        <div id="dmToast" class="toast" hidden>âœ”ï¸ Fotka pÅ™idÃ¡na do OS. KliknÄ›te â€Odeslatâ€œ.</div>
        <div class="composer sticky">
          <label class="filebtn"><input type="file" id="dmFile" accept="image/*" capture="environment">ğŸ“·</label>
          <input id="dmInput" placeholder="ZprÃ¡vaâ€¦">
          <button id="dmSend">Odeslat</button>
        </div>
      </div>
    </div>
  </section>

  <!-- FRIENDS -->
  <section id="view-friends" class="view">
    <div class="card">
      <header><b>PÅ™Ã¡telÃ©</b></header>
      <div class="row">
        <input id="friendEmail" placeholder="E-mail">
        <button id="friendAddBtn">PÅ™idat</button>
      </div>
      <div id="friendsList"></div>
      <hr>
      <div><b data-i18n="requests">Å½Ã¡dosti o pÅ™Ã¡telstvÃ­</b></div>
      <div class="row"><div style="flex:1"><b data-i18n="incoming">PÅ™Ã­chozÃ­</b><div id="reqIncoming"></div></div><div style="flex:1"><b data-i18n="outgoing">OdchozÃ­</b><div id="reqOutgoing"></div></div></div>
    </div>
  </section>

  <!-- HELP -->
  <section id="view-help" class="view">
    <div class="adm-only row">
      <input id="helpTitle" placeholder="Nadpis">
      <input id="helpLink" placeholder="Odkaz (https://â€¦)">
      <input id="helpImage" placeholder="URL obrÃ¡zku">
      <button id="helpPost">Publikovat</button>
    </div>
    <div id="helpGrid" class="cards"></div>
  </section>

  <!-- Announce -->
  <section id="view-announce" class="view">
    <div class="adm-only row">
      <input id="anTitle" placeholder="TÃ©ma">
      <input id="anImage" placeholder="URL fotky (volitelnÄ›)">
      <textarea id="anText" placeholder="Text"></textarea>
      <button id="anPost">Publikovat</button>
    </div>
    <div id="anGrid" class="cards"></div>
  </section>

  <!-- Admin -->
  <section id="view-admin" class="view">
    <div class="card adm-only">
      <h3 role="heading">Role / Moderace</h3>
      <div class="row">
        <input id="roleUid" placeholder="UID uÅ¾ivatele">
        <button id="makeMod">+ ModerÃ¡tor</button>
        <button id="removeMod">â€“ ModerÃ¡tor</button>
        <button id="ban30">â›” Ban 30 min</button>
        <input id="banReason" placeholder="DÅ¯vod">
        <button id="unban">âœ… Unban</button>
      </div>
      <h4>StÃ­Å¾nosti</h4>
      <div id="reportsBox"></div>
    </div>

    <div class="card adm-only">
      <h3>Boty</h3>
      <div class="row">
        <input id="botCity" placeholder="MÄ›sto (praha)">
        <input id="botText" placeholder="Text">
        <input id="botImage" placeholder="URL obrÃ¡zku (volitelnÄ›)">
        <select id="botInterval">
          <option value="2">kaÅ¾dÃ© 2 min</option>
          <option value="5">kaÅ¾dÃ½ch 5 min</option>
          <option value="15" selected>kaÅ¾dÃ½ch 15 min</option>
        </select>
        <button id="botStart">Start</button>
        <button id="botStop">Stop</button>
      </div>
    </div>
  </section>
</main>

<!-- Profile modal -->
<section id="view-profile" class="view">
  <div class="card">
    <header><b>MÅ¯j profil</b></header>
    <div class="row">
      <label class="filebtn"><input type="file" id="avatarFile" accept="image/*" capture="environment">ğŸ“·</label>
      <img id="myAvatar" class="ava-lg" src="./img/default-avatar.svg" alt="">
      <div>
        <div><b id="myName">Anonym</b></div>
        <div class="muted">Role: <span id="myRole">seeker</span> Â· Tarif: <span id="myPlan">free</span></div>
      </div>
    </div>
    <div class="row">
      <input id="setNick" placeholder="NovÃ½ nick">
      <input id="setAvatarUrl" placeholder="URL avataru (volitelnÄ›)">
      <select id="setRole">
        <option value="seeker">HledÃ¡m prÃ¡ci</option>
        <option value="employer">ZamÄ›stnavatel</option>
      </select>
      <button id="saveProfile">UloÅ¾it</button>
    </div>
    <div class="row">
      <button id="askNick"><span data-i18n="askNick">PoÅ¾Ã¡dat o zmÄ›nu nicku</span></button>
      <button id="qrPay"><span data-i18n="qrPay">QR platba</span></button>
      <button id="buyPremium"><span data-i18n="buyPremium">Koupit Premium</span></button>
      <button id="resetPass"><span data-i18n="resetPass">Obnovit heslo</span></button>
      <button id="btnSignout"><span data-i18n="signout">OdhlÃ¡sit</span></button>
    </div>
  </div>
</section>

<!-- Dasha greeting overlay -->
<div id="greetOverlay" class="modal" hidden>
  <div class="card" style="text-align:center">
    <header>
      <b>Ğ”Ğ»Ñ Ğ½Ğ°Ğ¹ĞºÑ€Ğ°ÑĞ¸Ğ²Ñ–ÑˆĞ¾Ñ— Ğ´Ñ–Ğ²Ñ‡Ğ¸Ğ½Ğ¸ ğŸŒ¹</b>
      <button id="greetClose">âœ–</button>
    </header>
    <div>
      <img src="./img/rose.svg" alt="rose" style="max-width:220px;margin:10px auto;display:block;border-radius:14px">
      <p>Ğ¢Ğ¸ Ğ½Ğ°Ğ¹ĞºÑ€Ğ°Ñ‰Ğ°! Ğ’Ñ–Ğ´ Ñ‚Ğ²Ğ¾Ñ€Ñ†Ñ ÑĞ°Ğ¹Ñ‚Ñƒ ğŸ’š</p>
      <div class="row" style="justify-content:center">
        <button data-view="view-dm">ĞĞ°Ğ¿Ğ¸ÑĞ°Ñ‚Ğ¸ Ğ² Ğ›Ğ¡</button>
        <button data-view="view-friends">Ğ”Ğ¾Ğ´Ğ°Ñ‚Ğ¸ Ğ² Ğ´Ñ€ÑƒĞ·Ñ–</button>
      </div>
    </div>
  </div>
</div>

<!-- libs -->
<script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-database-compat.js"></script>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<!-- app -->
<script src="./config.js"></script>
<script src="./utils.js"></script>
<script src="./i18n.js"></script>
<script src="./helpers.js"></script>
<script src="./chat.js"></script>
<script src="./dm.js"></script>
<script src="./friends.js"></script>
<script src="./map.js"></script>
<script src="./bots.js"></script>
<script src="./presence.js"></script>
<script src="./diagnostics.js"></script>
<script src="./auth.js"></script>
<script src="./rent.js"></script>
<script src="./app.js"></script>
<script src="./sw-register.js"></script>

</body>
</html>