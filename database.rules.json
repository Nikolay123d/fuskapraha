{
  "rules": {
    ".read": false,
    ".write": false,
    "usersPublic": {
      ".read": true,
      "$uid": {
        ".write": "auth != null && auth.uid === $uid",
        "nick": {
          ".validate": "newData.isString() && newData.val().length >= 2 && newData.val().length <= 24"
        },
        "photoURL": {
          ".validate": "newData.isString()"
        },
        "city": {
          ".validate": "newData.isString()"
        },
        "lang": {
          ".validate": "newData.isString()"
        },
        "ts": {
          ".validate": "newData.isNumber()"
        }
      }
    },
    "rooms": {
      ".read": true,
      "$roomId": {
        ".write": "auth != null && root.child('admins/' + auth.uid).val() === true",
        "title": {
          ".validate": "newData.isString() && newData.val().length > 0 && newData.val().length <= 40"
        },
        "city": {
          ".validate": "newData.isString()"
        },
        "ts": {
          ".validate": "newData.isNumber()"
        }
      }
    },
    "messages": {
      ".read": "auth != null",
      "$roomId": {
        ".indexOn": [
          "ts"
        ],
        "$msgId": {
          ".write": "auth != null && ( !data.exists() || data.child('uid').val() === auth.uid || root.child('admins/' + auth.uid).val() === true )",
          "uid": {
            ".validate": "newData.isString() && newData.val() === auth.uid"
          },
          "text": {
            ".validate": "newData.isString() && newData.val().length <= 2000"
          },
          "photoURL": {
            ".validate": "newData.isString()"
          },
          "ts": {
            ".validate": "newData.isNumber()"
          },
          "city": {
            ".validate": "newData.isString()"
          },
          "nick": {
            ".validate": "newData.isString()"
          }
        }
      }
    },
    "rentMessages": {
      ".read": "auth != null",
      "$city": {
        ".indexOn": [
          "ts"
        ],
        "$msgId": {
          ".write": "auth != null"
        }
      }
    },
    "profileChangeRequests": {
      ".read": "auth != null && root.child('admins/' + auth.uid).val() === true",
      ".write": "auth != null",
      ".indexOn": [
        "ts"
      ],
      "$id": {
        ".validate": "newData.hasChildren(['uid','ts'])"
      }
    },
    "admins": {
      ".read": "auth != null && root.child('admins/' + auth.uid).val() === true",
      "$uid": {
        ".write": "auth != null && root.child('admins/' + auth.uid).val() === true"
      }
    },
    "bans": {
      ".read": "auth != null && root.child('admins/' + auth.uid).val() === true",
      "$uid": {
        ".write": "auth != null && root.child('admins/' + auth.uid).val() === true"
      }
    }
  }
}